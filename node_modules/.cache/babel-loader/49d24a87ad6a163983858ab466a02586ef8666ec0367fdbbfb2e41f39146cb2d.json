{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import styled from'styled-components';import io from'socket.io-client';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const ChatContainer=styled.div`\n  padding: 10px;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;const MessagesContainer=styled.div`\n  flex: 1;\n  overflow-y: auto;\n  margin-bottom: 10px;\n`;const Message=styled.div`\n  margin: 5px 0;\n  padding: 8px;\n  border-radius: 4px;\n  background: ${props=>props.isOwn?'#DCF8C6':'#ECECEC'};\n  align-self: ${props=>props.isOwn?'flex-end':'flex-start'};\n  max-width: 70%;\n`;const MessageName=styled.div`\n  font-size: 12px;\n  color: #666;\n  margin-bottom: 4px;\n`;const InputContainer=styled.div`\n  display: flex;\n  gap: 10px;\n`;const Input=styled.input`\n  flex: 1;\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n`;const Button=styled.button`\n  padding: 8px 16px;\n  background: #007AFF;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n`;function Chat(_ref){let{userId}=_ref;const[messages,setMessages]=useState([]);const[message,setMessage]=useState('');const socketRef=useRef();const messagesEndRef=useRef(null);useEffect(()=>{socketRef.current=io('https://tuchki-zauchki.ru/telepets/');socketRef.current.on('message',msg=>{setMessages(prev=>[...prev,msg]);});return()=>{socketRef.current.disconnect();};},[]);useEffect(()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});},[messages]);const sendMessage=()=>{if(message.trim()){const newMessage={userId,text:message,timestamp:new Date().toISOString()};socketRef.current.emit('sendMessage',newMessage);setMessage('');}};return/*#__PURE__*/_jsxs(ChatContainer,{children:[/*#__PURE__*/_jsxs(MessagesContainer,{children:[messages.map((msg,index)=>/*#__PURE__*/_jsxs(Message,{isOwn:msg.userId===userId,children:[msg.userId!==userId&&/*#__PURE__*/_jsxs(MessageName,{children:[\"User \",msg.userId]}),msg.text]},index)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(InputContainer,{children:[/*#__PURE__*/_jsx(Input,{value:message,onChange:e=>setMessage(e.target.value),onKeyPress:e=>e.key==='Enter'&&sendMessage(),placeholder:\"\\u041D\\u0430\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435...\"}),/*#__PURE__*/_jsx(Button,{onClick:sendMessage,children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]});}export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","styled","io","jsxs","_jsxs","jsx","_jsx","ChatContainer","div","MessagesContainer","Message","props","isOwn","MessageName","InputContainer","Input","input","Button","button","Chat","_ref","userId","messages","setMessages","message","setMessage","socketRef","messagesEndRef","current","on","msg","prev","disconnect","_messagesEndRef$curre","scrollIntoView","behavior","sendMessage","trim","newMessage","text","timestamp","Date","toISOString","emit","children","map","index","ref","value","onChange","e","target","onKeyPress","key","placeholder","onClick"],"sources":["D:/Andre/telepets/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport io from 'socket.io-client';\r\n\r\nconst ChatContainer = styled.div`\r\n  padding: 10px;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst MessagesContainer = styled.div`\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  margin-bottom: 10px;\r\n`;\r\n\r\nconst Message = styled.div`\r\n  margin: 5px 0;\r\n  padding: 8px;\r\n  border-radius: 4px;\r\n  background: ${props => props.isOwn ? '#DCF8C6' : '#ECECEC'};\r\n  align-self: ${props => props.isOwn ? 'flex-end' : 'flex-start'};\r\n  max-width: 70%;\r\n`;\r\n\r\nconst MessageName = styled.div`\r\n  font-size: 12px;\r\n  color: #666;\r\n  margin-bottom: 4px;\r\n`;\r\n\r\nconst InputContainer = styled.div`\r\n  display: flex;\r\n  gap: 10px;\r\n`;\r\n\r\nconst Input = styled.input`\r\n  flex: 1;\r\n  padding: 8px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n`;\r\n\r\nconst Button = styled.button`\r\n  padding: 8px 16px;\r\n  background: #007AFF;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n`;\r\n\r\nfunction Chat({ userId }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [message, setMessage] = useState('');\r\n  const socketRef = useRef();\r\n  const messagesEndRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    socketRef.current = io('https://tuchki-zauchki.ru/telepets/');\r\n    \r\n    socketRef.current.on('message', (msg) => {\r\n      setMessages(prev => [...prev, msg]);\r\n    });\r\n\r\n    return () => {\r\n      socketRef.current.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  const sendMessage = () => {\r\n    if (message.trim()) {\r\n      const newMessage = {\r\n        userId,\r\n        text: message,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n      socketRef.current.emit('sendMessage', newMessage);\r\n      setMessage('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ChatContainer>\r\n      <MessagesContainer>\r\n        {messages.map((msg, index) => (\r\n          <Message key={index} isOwn={msg.userId === userId}>\r\n            {msg.userId !== userId && (\r\n              <MessageName>User {msg.userId}</MessageName>\r\n            )}\r\n            {msg.text}\r\n          </Message>\r\n        ))}\r\n        <div ref={messagesEndRef} />\r\n      </MessagesContainer>\r\n      <InputContainer>\r\n        <Input\r\n          value={message}\r\n          onChange={(e) => setMessage(e.target.value)}\r\n          onKeyPress={(e) => e.key === 'Enter' && sendMessage()}\r\n          placeholder=\"Напишите сообщение...\"\r\n        />\r\n        <Button onClick={sendMessage}>Отправить</Button>\r\n      </InputContainer>\r\n    </ChatContainer>\r\n  );\r\n}\r\n\r\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}